export class TypstCancellationToken {
    isCancellationRequested = false;
    _onCancelled;
    _onCancelledResolveResolved;
    constructor() {
        let resolveT = undefined;
        let resolveX = undefined;
        this._onCancelled = new Promise(resolve => {
            resolveT = resolve;
            if (resolveX) {
                resolveX(resolve);
            }
        });
        this._onCancelledResolveResolved = new Promise(resolve => {
            resolveX = resolve;
            if (resolveT) {
                resolve(resolveT);
            }
        });
    }
    async cancel() {
        await this._onCancelledResolveResolved;
        this.isCancellationRequested = true;
    }
    isCancelRequested() {
        return this.isCancellationRequested;
    }
    async consume() {
        (await this._onCancelledResolveResolved)();
    }
    wait() {
        return this._onCancelled;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwc3QtY2FuY2VsLm1qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb250cmliL2RvbS90eXBzdC1jYW5jZWwubXRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sT0FBTyxzQkFBc0I7SUFDakMsdUJBQXVCLEdBQVksS0FBSyxDQUFDO0lBQ2pDLFlBQVksQ0FBZ0I7SUFDNUIsMkJBQTJCLENBQXNCO0lBRXpEO1FBQ0UsSUFBSSxRQUFRLEdBQWUsU0FBVSxDQUFDO1FBQ3RDLElBQUksUUFBUSxHQUE0QixTQUFVLENBQUM7UUFDbkQsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUN4QyxRQUFRLEdBQUcsT0FBTyxDQUFDO1lBQ25CLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2IsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3BCLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQywyQkFBMkIsR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUN2RCxRQUFRLEdBQUcsT0FBTyxDQUFDO1lBQ25CLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2IsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3BCLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTTtRQUNWLE1BQU0sSUFBSSxDQUFDLDJCQUEyQixDQUFDO1FBQ3ZDLElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUM7SUFDdEMsQ0FBQztJQUVELGlCQUFpQjtRQUNmLE9BQU8sSUFBSSxDQUFDLHVCQUF1QixDQUFDO0lBQ3RDLENBQUM7SUFFRCxLQUFLLENBQUMsT0FBTztRQUNYLENBQUMsTUFBTSxJQUFJLENBQUMsMkJBQTJCLENBQUMsRUFBRSxDQUFDO0lBQzdDLENBQUM7SUFFRCxJQUFJO1FBQ0YsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQzNCLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBUeXBzdENhbmNlbGxhdGlvblRva2VuIHtcclxuICBpc0NhbmNlbGxhdGlvblJlcXVlc3RlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHByaXZhdGUgX29uQ2FuY2VsbGVkOiBQcm9taXNlPHZvaWQ+O1xyXG4gIHByaXZhdGUgX29uQ2FuY2VsbGVkUmVzb2x2ZVJlc29sdmVkOiBQcm9taXNlPCgpID0+IHZvaWQ+O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGxldCByZXNvbHZlVDogKCkgPT4gdm9pZCA9IHVuZGVmaW5lZCE7XHJcbiAgICBsZXQgcmVzb2x2ZVg6IChfOiAoKSA9PiB2b2lkKSA9PiB2b2lkID0gdW5kZWZpbmVkITtcclxuICAgIHRoaXMuX29uQ2FuY2VsbGVkID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgIHJlc29sdmVUID0gcmVzb2x2ZTtcclxuICAgICAgaWYgKHJlc29sdmVYKSB7XHJcbiAgICAgICAgcmVzb2x2ZVgocmVzb2x2ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdGhpcy5fb25DYW5jZWxsZWRSZXNvbHZlUmVzb2x2ZWQgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcclxuICAgICAgcmVzb2x2ZVggPSByZXNvbHZlO1xyXG4gICAgICBpZiAocmVzb2x2ZVQpIHtcclxuICAgICAgICByZXNvbHZlKHJlc29sdmVUKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjYW5jZWwoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBhd2FpdCB0aGlzLl9vbkNhbmNlbGxlZFJlc29sdmVSZXNvbHZlZDtcclxuICAgIHRoaXMuaXNDYW5jZWxsYXRpb25SZXF1ZXN0ZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgaXNDYW5jZWxSZXF1ZXN0ZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5pc0NhbmNlbGxhdGlvblJlcXVlc3RlZDtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNvbnN1bWUoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAoYXdhaXQgdGhpcy5fb25DYW5jZWxsZWRSZXNvbHZlUmVzb2x2ZWQpKCk7XHJcbiAgfVxyXG5cclxuICB3YWl0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX29uQ2FuY2VsbGVkO1xyXG4gIH1cclxufVxyXG4iXX0=